<h1>ebloc-broker</h1>
<p><code>eBlocBroker</code> is a smart contract as an autonomous volunteer computing and sharing data resource broker based on blockchain for e-Science.
  It applies blockchain technology to provide a market for computational and data resources to research communities.</p>
<ul>
  <li><a href="http://ebloc-broker-readthedocs.duckdns.org:8000/index.html">Documentation</a></li>
</ul>
<h2>Prerequisites</h2>
<ul>
  <li><a href="https://github.com/SchedMD/slurm">Slurm</a>,
    <a href="https://ipfs.io">IPFS</a>,
    <a href="https://github.com/eth-brownie/brownie">eth-brownie</a>,
    <a href="https://github.com/prasmussen/gdrive">prasmussen/gdrive</a>,
    <a href="https://github.com/owncloud/pyocclient">owncloud/pyocclient</a>,
    <a href="https://github.com/trufflesuite/ganache">ganache-cli</a>.</li>
</ul>
<h2>Using Docker</h2>
<p>You can use a sandbox container provided in the <a href="./docker-compose.yml">./docker-compose.yml</a> file for testing inside a Docker
  environment.</p>
<p>This container provides everything you need to test using a <code>Python 3.7</code> interpreter. Start the test environment:</p>
<pre class="src" lang="bash">
docker-compose up -d
</pre>
<p>To enter the shell of the running container in the interactive mode, run:</p>
<pre class="src" lang="bash">
docker exec --detach-keys=&quot;ctrl-e,e&quot; -it ebloc-broker_slurm_1 /bin/bash
</pre>
<p>To stop the container, run:</p>
<pre class="src" lang="bash">
docker-compose down
</pre>
<h2>Cloud Storages</h2>
<h3>B2DROP</h3>
<h4>Create B2ACCESS user account and login into B2DROP:</h4>
<p>First, from <a href="https://b2access.eudat.eu/home/">B2ACCESS home page</a></p>
<p><code>No account SignUp</code> =&gt; <code>Create B2ACCESS user account (username) only</code></p>
<ul>
  <li><a href="https://b2drop.eudat.eu/">B2DROP login site</a></li>
</ul>
<h4>Create app password</h4>
<p><code>Settings</code> =&gt; <code>Security</code> =&gt; <code>Create new app password</code> and save it.</p>
<h2>How to install required packages</h2>
<p>We have a helper script, which you can use to install all required external dependencies:</p>
<pre class="src" lang="bash">
source ./scripts/setup.sh
</pre>
<p>Next, type <code>eblocbroker --help</code> for basic usage information.</p>
<h2>Requester</h2>
<h3>Submit Job</h3>
<p>In order to submit your job each user should already registered into eBlocBroker using <code>eblocbroker register_provider ~/.ebloc-broker/cfg.yaml</code></p>
<p>After registration is done, each user should authenticate their ORCID iD using the following <a href="http://eblocbroker.duckdns.org/">http://eblocbroker.duckdns.org/</a>.</p>
<pre class="src" lang="bash">
$ eblocbroker submit job.yaml
</pre>
<h4>Example yaml file in order to define a job to submit.</h4>
<p><code>job.yaml</code>\:</p>
<pre class="src" lang="yaml">
config:
    provider_address: &#39;0x3e6ffc5ede9ee6d782303b2dc5f13afeee277aea&#39;
    source_code:
        cache_type: public
        path: ~/test_eblocbroker/source_code
        storage_hours: 0
        storage_id: ipfs
    data:
        data1:
            cache_type: public
            path: ~/test_eblocbroker/dataset_zip/small/KZ2-tsukuba
            storage_hours: 1
            storage_id: ipfs
        data2:
            cache_type: public
            path: ~/test_eblocbroker/test_data/base/data/data1
            storage_hours: 0
            storage_id: ipfs
        data3:
            hash: f13d75bc60898f0823566347e380a34b
    data_transfer_out: 1
    jobs:
        job1:
            cores: 1
            run_time: 1
</pre>
<ul>
  <li><code>path</code> should represented as full path of the corresponding folder.</li>
  <li><code>cache_type</code> should be variable from [ <code>public</code>, <code>private</code> ]</li>
  <li><code>storage_id</code> should be variable from [ <code>ipfs</code>, <code>ipfs_gpg</code>, <code>none</code>, <code>b2drop</code>, <code>gdrive</code> ]</li>
</ul>
<hr />
<h2>Provider</h2>
<p>Each provider should run <code>eblocbroker driver</code> for start running the Python script.</p>
<details><summary>Example screenshot of provider GUI:</summary>
<p><img src="/docs/gui1.png" alt="/docs/gui1.png" /></p>
</details>
<h2>ðŸŽ¬ Demonstration</h2>
<ul>
  <li><a href="https://asciinema.org/a/551809">https://asciinema.org/a/551809</a></li>
  <li><a href="https://asciinema.org/a/551843">https://asciinema.org/a/551843</a></li>
</ul>
<h2>Acknowledgement</h2>
<p>This work is supported by the Turkish Directorate of Strategy and Budget under the TAM Project
  number 2007K12-873.</p>
<p>Developed by Alper Alimoglu and Can Ozturan from Bogazici University, Istanbul.
  Contact <a href="mailto:alper.alimoglu@boun.edu.tr">alper.alimoglu@boun.edu.tr</a>, <a href="mailto:ozturaca@boun.edu.tr">ozturaca@boun.edu.tr</a> if necessary.</p>
