* NOTES

** Remove cache

- to delete all containers including its volumes use: ~docker rm -vf $(docker ps -aq)~
- to delete all the images: ~docker rmi -f $(docker images -aq)~

#+begin_src bash
remove_dangling () {
    docker images -qa -f 'dangling=true' | ifne docker rmi $(docker images -qa -f 'dangling=true') --force
    docker image ls
}
remove_dangling

# sudo systemctl start docker
# sudo docker run eblocbroker

# doocker run --name test -it eblocbroker bash
docker run --hostname slurmctl -it ebb bash
#+end_src

** Clean complete docker cache

#+begin_src bash
docker kill $(docker ps -q)
docker rmi $(docker images -a --filter=dangling=true -q) --force
docker rm $(docker ps --filter=status=exited --filter=status=created -q) --force
docker rmi $(docker images -a -q) --force
#+end_src

** PUSH

NOTE: Now in order to push the image just make sure the path which you are using must have your
username included in the tag.

#+begin_src bash
cat ~/.docker_password.txt | docker login --username eblocbroker --password-stdin
docker build -t ebb:latest . --progress plain
docker tag ebb:latest eblocbroker/app
docker push eblocbroker/app
#+end_src

~docker history --human --format "{{.CreatedBy}}: {{.Size}}" ebb~

#+begin_src bash
docker images ebb:latest --format "{{.Repository}}:{{.Tag}} -> {{.Size}}"
#+end_src

** Build

#+begin_src bash
docker build -t ebb:latest --progress plain .
#+end_src

** Compose-up

#+begin_src bash
docker-compose up -d
# or
docker-compose up --remove-orphans
#+end_src

** Image for service slurm was built because it did not already exist. To rebuild this image you must use:

#+begin_src bash
docker-compose up --build
#+end_src
